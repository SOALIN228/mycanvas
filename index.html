<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>canvas画板</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <canvas id="xxx" width="500" height="500"></canvas>
  <div id=actions class="actions">
    <button id=eraser>橡皮擦</button>
    <button id=brush>画笔</button>
  </div>
  <script>
  var yyy = document.getElementById('xxx')

  xxx()

  window.onresize = function () {
    xxx()
  }

  function xxx () {
    var pageWidth = document.documentElement.clientWidth
    var pageHeight = document.documentElement.clientHeight

    yyy.width = pageWidth
    yyy.height = pageHeight
  }

  var eraserEnabled = false
  eraser.onclick = function () {
    eraserEnabled = !eraserEnabled
  }

  var context = yyy.getContext('2d')

  var using = false
  var lastPoint = { x: undefined, y: undefined }

  // 按下鼠标
  yyy.onmousedown = function (aaa) {
    var x = aaa.clientX
    var y = aaa.clientY
    using = true
    if (eraserEnabled) {
      context.clearRect(x - 5, y - 5, 10, 10)
    } else {
      lastPoint = { x: x, y: y }
    }
  }

  // 拖动鼠标
  yyy.onmousemove = function (a) {
    var x = a.clientX
    var y = a.clientY
    if (eraserEnabled) {
      if (using) {
        context.clearRect(x - 5, y - 5, 10, 10)
      }
    } else {
      if (using) {
        var newPoint = { x: x, y: y }
        drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y)
        lastPoint = newPoint
      }
    }
  }

  // 松开鼠标
  yyy.onmouseup = function () {
    using = false
  }

  function drawCircle (x, y, radius) {
    context.beginPath()
    context.fillStyle = 'black'
    context.arc(x, y, radius, 0, Math.PI * 2)
    context.fill()
  }

  function drawLine (x1, y1, x2, y2) {
    context.beginPath()
    context.strokeStyle = 'black'
    context.moveTo(x1, y1) // 起点
    context.lineWidth = 5
    context.lineTo(x2, y2) // 终点
    context.stroke()
    context.closePath()
  }
  </script>
</body>
</html>
